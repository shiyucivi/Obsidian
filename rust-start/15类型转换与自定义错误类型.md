## 1 `From<T>`和`Into<T>` trait
From是标准库中用于安全地进行类型转换的trait。提供了一个from方法的签名。但没有具体实现。
```rust
pub trait From<T> {
  fn from(T) -> Self;
}
// 泛型参数T必须是具体类型或trait约束
impl From<String> for U {
  fn from(String) -> Self {
    //具体实现
  }
}
// 将泛型T转化为已实现的结构体类型U
```
错误转换最常用的场景是将标准库中的错误类型转为自己需要的错误类型
```rust
use std::fs;
use std::io;
use std::num::ParseIntError;
enum MyError {
  Io(io::Error),
  ParseInt(ParseIntError),
  Other(String)
}
//将io:Error类型转为MyError::Io类型
impl From<io::Error> for MyError {
  fn from(value: io::Error) -> Self {
    MyError::Io(value)
  }
}

fn read_file() -> Result<String, MyError> {
  let content = fs::read_to_string("file.txt")?; //?会根据函数签名，自动调用MyError::from将io::Error转为MyError
  Ok(content)
}
```
如果一个结构体U实现了`From<T> trait`，会默认对T实现了返回U的Into方法，但实现了Into不会自动实现From trait：
```rust
struct Wrapper(i32);
impl From<i32> for Wrapper {
    fn from(value: i32) -> Self {
        Wrapper(value)
    }
}
fn main() {
    let w: Wrapper = 42.into(); // 自动调用 From<i32> 的实现
    println!("{}", w.0); // 输出 42
}
```
在上面的错误转换例子中：
```rust
fn ioerror_into_myerror {
  let content: Result<String, io::Error> = fs::read_to_string("file.txt");
  match content {
	Ok(content) => Ok(content),
	Err(error) => Err(error.into()) //error类型为io::Error，into返回MyError类型
  }
}
```
## 2 `TryFrom<T>`和`TryInto<T>` trait
对From trait进行实现时，必须是成功的实现。否则应该使用`TryFrom<T>`和`TryInto<T>`。
try_from和try_into方法返回一个Result。
例如将一个i32数字转为u8数字：
```rust
struct Color {
    red: u8,
    green: u8,
    blue: u8,
}
enum IntoColorError {
    BadLen,
    IntConversion
}
impl TryFrom<(i16, i16, i16)> for Color {
    type Error = IntoColorError;
    fn try_from(tuple: (i16, i16, i16)) -> Result<Self, Self::Error> {
        let (red, green, blue) = tuple;
        let range = 0..=255;
        if range.contains(&red)&&range.contains(&blue)&&range.contains(&green){
            Ok(Color {
                red: red.try_into().unwrap(),
                green: green.try_into().unwrap(),
                blue: blue.try_into().unwrap()
            })
        } else {
            Err(IntoColorError::IntConversion)
        }
    }
}
```
### 3 As操作符
`as` 操作符和 `into()` 方法（通常通过 `Into` trait 使用）都可用于类型转换，但as操作符是系统内置的语法，只能用于基础数据类型（数字、bool、指针等），不能用于复合数据类型。
```rust
let x: i32 = 1000; 
let y: u8 = x as u8; // 静默截断！y = 232 (1000 % 256)
```