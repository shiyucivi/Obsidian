### 1 模式匹配与错误传播
针对异步任务中的错误，进行match处理，避免panic
```rust
use std::{net::TcpStream};
fn main() {
	let result = TcpStream::connect("127.0.0.1:8080");
	match result {
		Ok(stream) => {println!("success")},
		Err(e) => {println!("connect failed:{e:#?}")}
	}
}
```
#### 1.1 使用?进行错误传播
针对result表达式使用?操作符返回一个Err。
```rust
use std::{net::TcpStream};
fn main() {
	if let Ok(stream) = connect_and_validate("127.0.0.1:8080") {
		println!("connected: {stream:#?}");
	}
}
fn connect_and_validate(address: &str) -> Result<TcpStream, std::io::Error> {
	let stream = TcpStream::connect(address)?;
	Ok(stream);
}
```
### 2 处理多种错误类型
#### 2.1 使用`Box<dyn std::error:Error>`
使用`Box<dyn std::error:Error>`来处理一个函数中多处使用?从而可能返回多种类型Error的情况：
```rust
use std::{net::TcpStream, error:Error};
fn parse_address(content: &str) -> Result<(String, u16), ParseIntError> {
	let parts: Vec<&str> = content.split(";").collection;
	let host = parts[0].to_string();
	let port = parts[1].parse::<u16>()?;
	Ok((host, port))
}
fn load_config_and_connect() -> Result<TcpStream, Box<dyn Error>> {
	let config_file = Path::new("serve.txt");
	//这里可能返回错误类型为io::Error
	let raw_text = fs::read_to_string(config_file)?;
	//这里可能返回错误类型为ParseIntError
	let (host, port) = parse_address(raw_text.trim())?;
	let address = format!("{host}:{port}");
	//这里可能返回错误类型为标准Error
	let stream = TcpStream::connect(&address)?;
	Ok(stream);
}
```
#### 2.2 使用anyhow库
- `anyhow::Error` 是基于 `Box<dyn std::error::Error + Send + Sync>`实现的一个动态错误类型。它可以自动包装任何实现了 `std::error::Error` 的错。
```rust
use anyhow::Result; 
//将每处可能出现的错误转为为anyhow::Error类型
fn read_and_parse() -> Result<String> { 
	let content = std::fs::read_to_string("config.json")?; // io::Error → anyhow::Error 
	let value: serde_json::Value = serde_json::from_str(&content)?; // serde_json::Error → anyhow::Error 
	Ok(value.to_string()) 
}
```
### 3 自定义错误
可以使用thiserror这个库来为自定义的Error类型来快速实现错误需要实现的trait
```rust
use thiserror::Error; 
#[derive(Error, Debug)] 
pub enum MyError {
	#[error("文件未找到: {0}")] 
	FileNotFound(String), 
	#[error("IO 错误")] 
	Io(#[from] std::io::Error), 
	#[error("无效输入字段 `{field}`: {reason}")] 
	ValidationError { field: &'static str, reason: String, }
}
```
thiserror的error宏可以接收插值字段。更准确地打印错误信息。
### 4 异步错误
